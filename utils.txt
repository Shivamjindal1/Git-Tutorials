utility functoins for version-2